<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="#{title.search}">Zelora Product Search</title>

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
</head>

<body>

<h1 th:text="#{title.search}">Zelora Product Search</h1>

<form method="get" action="/search/results" class="search-form">

    <label for="name" th:text="#{label.name}">Product Name</label>
    <input type="text" id="name" name="name" th:placeholder="#{placeholder.name}">

    <label for="category" th:text="#{label.category}">Category</label>
    <input type="text" id="category" name="category" th:placeholder="#{placeholder.category}">

    <label for="minPrice" th:text="#{label.minPrice}">Min Price (‚Ç¨)</label>
    <input type="number" step="0.01" id="minPrice" name="minPrice">

    <label for="maxPrice" th:text="#{label.maxPrice}">Max Price (‚Ç¨)</label>
    <input type="number" step="0.01" id="maxPrice" name="maxPrice">

    <label th:text="#{label.keyword}">Keyword</label>
    <input type="text" name="keyword" th:placeholder="#{placeholder.keyword}">

    <label>
        <input type="checkbox" name="recent">
        <span th:text="#{label.recent}">Recent</span>
    </label>

    <button type="submit" th:text="#{button.search}">Search</button>
</form>

<hr>

<h2 th:text="#{header.results}">Search Results</h2>

<table id="resultsTable" class="display" style="width:100%">
    <thead>
    <tr>
        <th>Image</th>
        <th th:text="#{column.product}">Product</th>
        <th th:text="#{column.category}">Category</th>
        <th th:text="#{column.price}">Price</th>
        <th th:text="#{column.releaseDate}">Release Date</th>
        <th th:text="#{column.discountedPrice}">Discounted Price</th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="p : ${products}">
        <td>
            <img th:src="@{'/images/thumbs/' + ${p.productId} + '/' + ${p.featureImage} }"
                 alt="Thumbnail"
                 style="width:60px; height:auto; border-radius:4px;">
        </td>

        <td>
            <a th:href="@{|/search/product/${p.productId}|}"
               th:text="${p.productName}"></a>
        </td>
        <td th:text="${p.categoryId.categoryName}"></td>
        <td th:text="${p.price}"></td>
        <td th:text="${#dates.format(p.releaseDate, 'yyyy-MM-dd')}"></td>
        <td th:text="${p.discountedPrice != null ? p.discountedPrice : p.price}"></td>
    </tr>
    </tbody>
</table>

<script>
    $(document).ready(function() {
        $('#resultsTable').DataTable({
            "pageLength": 10,
            "language": {
                "search": "",
                "searchPlaceholder": "üîç Search..."
            }
        });
    });
</script>

<hr>

<!-- Language Switcher -->
<a href="?lang=en">English</a> |
<a href="?lang=fr">Fran√ßais</a> |
<a href="?lang=es">Espa√±ol</a>

</body>
</html>
